/* themes.css ‚Äî Th√®mes via variables (viewer.css reste propre)
   Auto (par d√©faut) suit le th√®me Windows via prefers-color-scheme.

   ‚úÖ IMPORTANT :
   - Les variables utilis√©es par html{ background: var(--bg) } doivent √™tre sur :root (= html)
   - Donc on force les th√®mes sur :root[data-theme="..."] (et non body)
*/

html, body { min-height: 100%; }

/* =========================================================
   BASE : petits overrides communs (tous th√®mes)
   ========================================================= */
:root{
  /* valeurs fallback si un th√®me ne d√©finit pas tout */
  --overlay-bg: rgba(0,0,0,0.55);
  --thumb-bg: rgba(255,255,255,0.06);
  --thumb-fallback-bg: rgba(0,0,0,0.15);

  --border-soft: rgba(255,255,255,0.06);
  --top-actions-border: rgba(255,255,255,0.03);

  --soft-04: rgba(255,255,255,0.04);
  --soft-05: rgba(255,255,255,0.05);
}


/* =========================================================
   AUTO (par d√©faut) = TON TH√àME CLAIR
   - s'applique quand aucun data-theme n'est forc√©
   ========================================================= */
:root:not([data-theme]){
  /* <-- COPIE ICI EXACTEMENT les variables de ton th√®me clair premium */
  --bg:#f6f7fb;
  --bg2:#ffffff;
  --fg:#141824;
  --muted:#525b71;

  --primary:#2d6cdf;
  --accent:#0f7b50;

  --border:#d9deeb;
  --border-soft: rgba(20,24,36,0.10);

  --card:#ffffff;
  --btn:#eef2fb;

  --title:#0f1320;
  --topbar-bg: rgba(246,247,251,.88);

  --body-grad-1:#f6f7fb;
  --body-grad-2:#f3f6ff;
  --body-grad-3:#f7f7fa;

  --popover-bg: rgba(255,255,255,0.94);
  --hover-bg: rgba(20,24,36,0.06);

  --overlay-bg: rgba(12,14,18,0.45);

  --thumb-bg: rgba(45,108,223,0.08);
  --thumb-fallback-bg: rgba(20,24,36,0.06);

  --scrollbar-thumb:#c4cadb;
  --scrollbar-track:#eef1f8;
  --scrollbar-track-webkit: var(--scrollbar-track);
  --scrollbar-thumb-webkit: var(--scrollbar-thumb);
  --scrollbar-thumb-webkit-hover:#b0b7cc;

  --top-actions-border: rgba(20,24,36,0.05);
  --soft-04: rgba(20,24,36,0.04);
  --soft-05: rgba(20,24,36,0.06);

  --card-hover-border: rgba(45,108,223,0.55);
  --card-hover-shadow:
    0 0 0 1px rgba(45,108,223,0.18),
    0 14px 38px rgba(17,19,24,0.12);
  --card-hover-bg: var(--card);

  color-scheme: light;
}

/* gradient uniquement quand c'est clair (auto clair, clair, white) */
:root:not([data-theme]) body,
:root[data-theme="clair"] body,
:root[data-theme="white"] body{
  background:
    radial-gradient(1200px 600px at 18% 0%, rgba(45,108,223,0.10), transparent 60%),
    radial-gradient(900px 500px at 90% 10%, rgba(15,123,80,0.08), transparent 55%),
    linear-gradient(180deg, var(--body-grad-1), var(--body-grad-2) 30%, var(--body-grad-3));
  background-attachment: fixed;
}

/* auto + Windows sombre => pas de gradient clair */
@media (prefers-color-scheme: dark){
  :root:not([data-theme]) body{
    background: none;
  }
}


/* =========================================================
   AUTO + Windows sombre = TON TH√àME SOMBRE
   (uniquement si aucun data-theme n'est forc√©)
   ========================================================= */
@media (prefers-color-scheme: dark){
  :root:not([data-theme]){
    /* <-- COPIE ICI EXACTEMENT les variables de :root[data-theme="dark"] */
    --bg:#0f1117;
    --bg2:#141826;
    --fg:#e8eaf0;
    --muted:#aab2c8;
    --primary:#5aa2ff;
    --accent:#6ce0b0;
    --border:#23283b;
    --card:#171b29;
    --btn:#1e2437;

    --title: var(--fg);
    --topbar-bg: rgba(16,20,37,.9);

    --body-grad-1:#0d1018;
    --body-grad-2:#101425;
    --body-grad-3:#0f1117;

    --popover-bg: rgba(20,24,38,0.98);
    --hover-bg: rgba(255,255,255,0.06);

    --scrollbar-thumb:#303a57;
    --scrollbar-track:#0b0e14;
    --scrollbar-track-webkit: var(--scrollbar-track);
    --scrollbar-thumb-webkit: var(--scrollbar-thumb);
    --scrollbar-thumb-webkit-hover:#3f4b6b;

    --card-hover-border: rgba(255,255,255,0.22);
    --card-hover-shadow:
      0 0 0 1px rgba(255,255,255,0.18),
      0 0 22px -6px rgba(255,255,255,0.18),
      0 14px 38px rgba(0,0,0,0.45);
    --card-hover-bg: var(--card);

    color-scheme: dark;
  }
}


/* =========================================================
   FORC√â : sombre (identique √† ton style actuel)
   ========================================================= */
:root[data-theme="dark"]{
  --bg:#0f1117;
  --bg2:#141826;
  --fg:#e8eaf0;
  --muted:#aab2c8;
  --primary:#5aa2ff;
  --accent:#6ce0b0;
  --border:#23283b;
  --card:#171b29;
  --btn:#1e2437;

  --title: var(--fg);
  --topbar-bg: rgba(16,20,37,.9);

  --body-grad-1:#0d1018;
  --body-grad-2:#101425;
  --body-grad-3:#0f1117;

  --popover-bg: rgba(20,24,38,0.98);
  --hover-bg: rgba(255,255,255,0.06);

  --scrollbar-thumb:#303a57;
  --scrollbar-track:#0b0e14;
  --scrollbar-track-webkit: var(--scrollbar-track);
  --scrollbar-thumb-webkit: var(--scrollbar-thumb);
  --scrollbar-thumb-webkit-hover:#3f4b6b;

  /* ‚úÖ hover ‚Äútheme engine‚Äù (dark) */
  --card-hover-border: rgba(255,255,255,0.22);
  --card-hover-shadow:
    0 0 0 1px rgba(255,255,255,0.18),
    0 0 22px -6px rgba(255,255,255,0.18),
    0 14px 38px rgba(0,0,0,0.45);
  --card-hover-bg: var(--card);

  color-scheme: dark;
}


/* =========================================================
   FORC√â : clair (alias : white) ‚Äî clair premium, pas ‚Äúblanc pur‚Äù
   ========================================================= */
:root[data-theme="clair"],
:root[data-theme="white"]{
  --bg:#f6f7fb;
  --bg2:#ffffff;
  --fg:#141824;
  --muted:#525b71;

  --primary:#2d6cdf;
  --accent:#0f7b50;

  --border:#d9deeb;
  --border-soft: rgba(20,24,36,0.10);

  --card:#ffffff;
  --btn:#eef2fb;

  --title:#0f1320;
  --topbar-bg: rgba(246,247,251,.88);

  --body-grad-1:#f6f7fb;
  --body-grad-2:#f3f6ff;
  --body-grad-3:#f7f7fa;

  --popover-bg: rgba(255,255,255,0.94);
  --hover-bg: rgba(20,24,36,0.06);

  --overlay-bg: rgba(12,14,18,0.45);

  --thumb-bg: rgba(45,108,223,0.08);
  --thumb-fallback-bg: rgba(20,24,36,0.06);

  --scrollbar-thumb:#c4cadb;
  --scrollbar-track:#eef1f8;
  --scrollbar-track-webkit: var(--scrollbar-track);
  --scrollbar-thumb-webkit: var(--scrollbar-thumb);
  --scrollbar-thumb-webkit-hover:#b0b7cc;

  --top-actions-border: rgba(20,24,36,0.05);
  --soft-04: rgba(20,24,36,0.04);
  --soft-05: rgba(20,24,36,0.06);

  --card-hover-border: rgba(45,108,223,0.55);
  --card-hover-shadow:
    0 0 0 1px rgba(45,108,223,0.18),
    0 14px 38px rgba(17,19,24,0.12);
  --card-hover-bg: var(--card);

  color-scheme: light;
}

/* =========================================================
   NO√ãL (sapin + rouge) + FOND FIXE + FX ANIM√âS SUR HTML
   - Body transparent (pas de coupure bas)
   - NE CASSE PAS le hamburger / popover
   ========================================================= */

:root[data-theme="noel"]{
  /* üåå fond nuit hivernale */
  --bg:#061611;
  --bg2:#0a2018;

  /* ‚ùÑÔ∏è texte neige */
  --fg:#f4fff9;
  --muted:#c7e6d6;

  /* üéÑ vert sapin */
  --primary:#1faa59;

  /* üéÖ rouge BIEN visible */
  --accent:#ff3b3b;

  --border:#1f5a43;

  /* cartes plus neutres */
  --card:#0f1c17;
  --btn:#163a2c;

  --title: var(--fg);

  /* üî• Topbar avec reflet rouge */
  --topbar-bg: linear-gradient(
    90deg,
    rgba(6,22,17,.95),
    rgba(255,59,59,.22)
  );

  --body-grad-1:#040d0a;
  --body-grad-2:#061611;
  --body-grad-3:#0b2219;

  --popover-bg: rgba(15,28,23,.98);
  --hover-bg: rgba(255,255,255,0.08);

  --scrollbar-thumb:#2f8f68;
  --scrollbar-track:#030a07;
  --scrollbar-thumb-webkit-hover:#3fb07c;

  /* hover No√´l */
  --card-hover-border: #ff3b3b;
  --card-hover-shadow:
    0 0 0 1px rgba(255,59,59,.65),
    0 0 26px rgba(255,59,59,.22),
    0 18px 44px rgba(0,0,0,.55);
  --card-hover-bg:
    linear-gradient(145deg, rgba(255,59,59,.10), rgba(31,170,89,.08));

  color-scheme: dark;

  /* ‚úÖ FOND FIXE SUR HTML (√©vite la coupure bas) */
  background:
    radial-gradient(circle at 10% 20%, rgba(255,255,255,0.22) 0 1px, transparent 2px),
    radial-gradient(circle at 30% 80%, rgba(255,255,255,0.18) 0 1px, transparent 2px),
    radial-gradient(circle at 70% 35%, rgba(255,255,255,0.20) 0 1px, transparent 2px),
    radial-gradient(circle at 85% 70%, rgba(255,255,255,0.16) 0 1px, transparent 2px),

    radial-gradient(1200px 700px at 15% 0%, rgba(24,195,122,0.18), transparent 60%),
    radial-gradient(1100px 650px at 85% 10%, rgba(255,47,67,0.12), transparent 55%),
    radial-gradient(900px 600px at 60% 0%, rgba(72,155,255,0.12), transparent 60%),

    linear-gradient(180deg, #04080c 0%, #050d12 35%, #07151f 100%);

  background-attachment: fixed;
}

/* ‚úÖ BODY TRANSPARENT (sinon trait/coupure bas) */
:root[data-theme="noel"] body{
  background: transparent !important;
  position: relative;
  z-index: 0;
  isolation: isolate;
}

/* =========================================================
   FX ANIM√âS SUR HTML (derri√®re UI, safe pour menu)
   - ::before = aurore + scintillement
   - ::after  = neige (multi-couches)
   ========================================================= */

:root[data-theme="noel"]::before,
:root[data-theme="noel"]::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1; /* üî• derri√®re le contenu => menu OK */
  will-change: background-position, transform, opacity;
}

/* ‚úÖ Aurore + scintillement */
:root[data-theme="noel"]::before{
  background-repeat: no-repeat;
  background-position: center;
  opacity: .22;
  mix-blend-mode: screen;
  background:
    radial-gradient(1200px 700px at 15% 0%, rgba(24,195,122,0.22), transparent 60%),
    radial-gradient(1100px 650px at 85% 10%, rgba(255,47,67,0.16), transparent 55%),
    radial-gradient(900px 600px at 60% 0%, rgba(72,155,255,0.16), transparent 60%),
    radial-gradient(circle at 12% 18%, rgba(255,255,255,.10) 0 1px, transparent 2px),
    radial-gradient(circle at 72% 28%, rgba(255,255,255,.08) 0 1px, transparent 2px),
    radial-gradient(circle at 34% 74%, rgba(255,255,255,.06) 0 1px, transparent 2px);
  filter: blur(14px);
  animation: noelAurora 14s ease-in-out infinite alternate, noelTwinkle 3.8s steps(2,end) infinite;
}

/* ‚úÖ Neige qui tombe (2 couches dans le m√™me overlay) */
:root[data-theme="noel"]::after{
  background-repeat: repeat;
  opacity: .55;
  background-image:
    radial-gradient(circle, rgba(255,255,255,.95) 0 1.25px, transparent 1.8px),
    radial-gradient(circle, rgba(255,255,255,.70) 0 1.05px, transparent 1.7px),
    radial-gradient(circle, rgba(255,255,255,.75) 0 0.85px, transparent 1.35px),
    radial-gradient(circle, rgba(255,255,255,.45) 0 0.70px, transparent 1.25px);
  background-size:
    120px 160px,
    210px 140px,
    220px 260px,
    340px 280px;
  background-position:
    0   -220px,
    80px -140px,
    40px -320px,
    160px -240px;
  filter: blur(.20px);
  animation: noelSnowAll 15.5s linear infinite;
}

/* Animations */

@keyframes noelSnowAll{
  0%{
    background-position:
      0   -220px,
      80px -140px,
      40px -320px,
      160px -240px;
    transform: translateX(0);
  }
  25%{
    background-position:
      18px -40px,
      60px  60px,
      56px -140px,
      140px -10px;
    transform: translateX(6px);
  }
  55%{
    background-position:
      -10px 180px,
      95px  280px,
      28px  140px,
      190px 240px;
    transform: translateX(-5px);
  }
  80%{
    background-position:
      22px 360px,
      70px  420px,
      50px  360px,
      150px 420px;
    transform: translateX(4px);
  }
  100%{
    background-position:
      8px 560px,
      78px  520px,
      44px  560px,
      168px 520px;
    transform: translateX(0);
  }
}

@keyframes noelAurora{
  from{ transform: translate3d(-2%, -1%, 0) scale(1.02); opacity: .18; }
  to  { transform: translate3d( 2%,  1%, 0) scale(1.05); opacity: .26; }
}

@keyframes noelTwinkle{
  0%{ opacity:.18; }
  20%{ opacity:.26; }
  35%{ opacity:.16; }
  55%{ opacity:.28; }
  70%{ opacity:.20; }
  100%{ opacity:.22; }
}

@media (prefers-reduced-motion: reduce){
  :root[data-theme="noel"]::before,
  :root[data-theme="noel"]::after{
    animation: none !important;
  }
}


/* =========================================================
   HALLOWEEN (cinematic pumpkin + FX fond)
   ========================================================= */
:root[data-theme="halloween"]{
  position: relative;

  /* couleurs UI */
  --bg:#08050c;
  --bg2:#110916;

  --fg:#fff3e6;
  --muted:#e4c9a6;

  --primary:#ff7a00;
  --accent:#9c6bff;

  --border:#3a1f4d;
  --card:#140a1a;
  --btn:#1c0f25;

  --title: var(--fg);

  --topbar-bg: linear-gradient(
      90deg,
      rgba(8,5,12,.95),
      rgba(255,122,0,.22)
  );

  --body-grad-1:#050308;
  --body-grad-2:#08050c;
  --body-grad-3:#120816;

  --popover-bg: rgba(20,10,26,.98);
  --hover-bg: rgba(255,255,255,0.06);

  --scrollbar-thumb:#6a35a0;
  --scrollbar-track:#030205;
  --scrollbar-thumb-webkit-hover:#8446c8;

  --card-hover-border: #ff7a00;
  --card-hover-shadow:
    0 0 0 1px rgba(255,122,0,.70),
    0 0 30px rgba(255,122,0,.22),
    0 18px 44px rgba(0,0,0,.60);
  --card-hover-bg:
    linear-gradient(145deg, rgba(255,122,0,.10), rgba(156,107,255,.07));

  /* üëÄ yeux (d√©sactiv√©s par d√©faut, activ√©s via data-idle="1") */
  --eyes-a: 0;

  color-scheme: dark;

  /* üéÉ FX fond DIRECTEMENT sur html */
  background:
    radial-gradient(circle at 12% 18%, rgba(255,140,0,0.20) 0 1px, transparent 2px),
    radial-gradient(circle at 30% 82%, rgba(255,120,0,0.16) 0 1px, transparent 2px),
    radial-gradient(circle at 70% 35%, rgba(180,120,255,0.18) 0 1px, transparent 2px),
    radial-gradient(circle at 85% 70%, rgba(255,90,0,0.14) 0 1px, transparent 2px),

    radial-gradient(1200px 700px at 20% 10%, rgba(156,107,255,0.16), transparent 60%),
    radial-gradient(900px 500px at 85% 15%, rgba(255,122,0,0.18), transparent 55%),
    radial-gradient(1100px 800px at 50% 90%, rgba(120,0,255,0.10), transparent 60%),

    linear-gradient(180deg, #050308 0%, #07040d 35%, #120816 100%);

  background-attachment: fixed;
}

/* body transparent ‚Üí √©vite la coupure bas de page */
:root[data-theme="halloween"] body{
  background: transparent !important;
  position: relative;
  z-index: 0;
  isolation: isolate;
}

/* üëÄ active les yeux quand tu restes immobile (n√©cessite JS qui met data-idle="1" sur :root) */
:root[data-theme="halloween"][data-idle="1"]{
  --eyes-a: 0.90;
}


/* =========================================================
   HALLOWEEN ‚Äî FX ANIM√âS SUR HTML (brume + flicker bougie)
   - NE CASSE PAS le menu (popover fixed)
   ========================================================= */

/* ‚úÖ FX derri√®re tout le contenu (les 2 pseudo-√©l√©ments existent) */
:root[data-theme="halloween"]::before,
:root[data-theme="halloween"]::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background-repeat: no-repeat;
}

/* üå´Ô∏è brume + üëÄ yeux (invisibles tant que --eyes-a=0) */
:root[data-theme="halloween"]::before{
  opacity: .70;
  background:
    /* üëÄ paires d'yeux (2 spots) */
    radial-gradient(22px 12px at 62% 44%, rgba(255,208,120,var(--eyes-a)) 0 35%, rgba(255,208,120,0) 70%),
    radial-gradient(22px 12px at 66% 44%, rgba(255,208,120,var(--eyes-a)) 0 35%, rgba(255,208,120,0) 70%),
    radial-gradient(18px 10px at 28% 62%, rgba(255,208,120,calc(var(--eyes-a) * .85)) 0 35%, rgba(255,208,120,0) 70%),
    radial-gradient(18px 10px at 31% 62%, rgba(255,208,120,calc(var(--eyes-a) * .85)) 0 35%, rgba(255,208,120,0) 70%),

    /* üå´Ô∏è brume */
    radial-gradient(520px 520px at 88% 12%, rgba(255,170,60,.22), transparent 62%),
    radial-gradient(260px 260px at 88% 12%, rgba(255,170,60,.10), transparent 64%),
    radial-gradient(900px 520px at 18% 22%, rgba(156,107,255,.14), transparent 62%),
    radial-gradient(1200px 700px at 40% 90%, rgba(255,122,0,.10), transparent 62%);
  filter: blur(12px);
  animation: halloweenFog 14s ease-in-out infinite alternate;
}

/* üî• flicker ‚Äúbougie‚Äù */
:root[data-theme="halloween"]::after{
  opacity: .12;
  background:
    radial-gradient(900px 520px at 55% 20%, rgba(255,122,0,.70), transparent 68%),
    radial-gradient(700px 420px at 25% 70%, rgba(255,122,0,.35), transparent 72%);
  mix-blend-mode: screen;
  animation: halloweenFlicker 3.6s steps(2, end) infinite;
}

/* ‚úÖ animation brume SANS transform */
@keyframes halloweenFog{
  0%   { opacity:.62; background-position: 0% 0%; }
  50%  { opacity:.78; background-position: 3% 0%; }
  100% { opacity:.62; background-position:-3% 0%; }
}

@keyframes halloweenFlicker{
  0%{ opacity:.08; }
  18%{ opacity:.14; }
  26%{ opacity:.06; }
  52%{ opacity:.16; }
  68%{ opacity:.10; }
  100%{ opacity:.12; }
}


/* =====================================================
   THEME HOVER ENGINE (1 seule fois)
   - Rend les th√®mes VRAIMENT visibles
   ===================================================== */
.card{
  transition:
    transform .18s ease,
    box-shadow .18s ease,
    border-color .18s ease,
    background .18s ease;
}

.card:hover{
  transform: translateY(-4px);
  border-color: var(--card-hover-border, var(--border));
  box-shadow: var(--card-hover-shadow, 0 12px 34px rgba(0,0,0,.25));
  background: var(--card-hover-bg, var(--card));
}



/* =====================================================
   AJOUTS FX ‚Äî NO√ãL üéÑ
   - Guirlande lumineuse en haut (ampoules qui ‚Äúclignotent‚Äù)
   - Souffle froid au scroll (brume verticale l√©g√®re)
   - √âtincelles autour du curseur (n√©cessite JS pour --mx/--my)
   ===================================================== */

/* üéÑ Guirlande sur la topbar (safe : z-index √©lev√©, pointer-events none) */
:root[data-theme="noel"] header.topbar,
:root[data-theme="noel"] .topbar{
  position: sticky; /* si d√©j√† sticky, ok */
  z-index: 50;
}

:root[data-theme="noel"] header.topbar::before,
:root[data-theme="noel"] .topbar::before{
  content:"";
  position:absolute;
  left:0; right:0;
  top:-1px;
  height: 34px;
  pointer-events:none;
  z-index: 2;
  /* fil + petites ampoules (pattern) */
  background:
    /* fil */
    linear-gradient(180deg, rgba(0,0,0,0.0), rgba(0,0,0,0.0) 10px, rgba(10,30,22,.65) 11px, rgba(10,30,22,0) 12px),
    /* ampoules (r√©p√©tition) */
    radial-gradient(circle at 12px 12px, rgba(255,70,70,.95) 0 3px, rgba(255,70,70,0) 8px),
    radial-gradient(circle at 34px 14px, rgba(80,210,140,.95) 0 3px, rgba(80,210,140,0) 8px),
    radial-gradient(circle at 58px 12px, rgba(90,170,255,.95) 0 3px, rgba(90,170,255,0) 8px),
    radial-gradient(circle at 82px 14px, rgba(255,210,90,.95) 0 3px, rgba(255,210,90,0) 8px);
  background-size:
    100% 100%,
    110px 34px,
    110px 34px,
    110px 34px,
    110px 34px;
  background-repeat: no-repeat, repeat, repeat, repeat, repeat;
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.35));
  opacity: .92;
  animation: noelGarlandBlink 4.2s steps(2,end) infinite;
}

/* deuxi√®me couche pour simuler ‚Äúal√©atoire‚Äù (dur√©e diff√©rente) */
:root[data-theme="noel"] header.topbar::after,
:root[data-theme="noel"] .topbar::after{
  content:"";
  position:absolute;
  left:0; right:0;
  top:0;
  height: 34px;
  pointer-events:none;
  z-index: 2;
  background:
    radial-gradient(circle at 22px 16px, rgba(255,255,255,.85) 0 2px, rgba(255,255,255,0) 7px),
    radial-gradient(circle at 74px 16px, rgba(255,255,255,.80) 0 2px, rgba(255,255,255,0) 7px);
  background-size: 160px 34px;
  background-repeat: repeat;
  opacity: .35;
  mix-blend-mode: screen;
  animation: noelGarlandSpark 6.6s steps(2,end) infinite;
}

@keyframes noelGarlandBlink{
  0%   { opacity:.92; }
  18%  { opacity:.70; }
  35%  { opacity:.95; }
  52%  { opacity:.78; }
  67%  { opacity:.96; }
  82%  { opacity:.74; }
  100% { opacity:.92; }
}
@keyframes noelGarlandSpark{
  0%   { opacity:.18; }
  22%  { opacity:.42; }
  37%  { opacity:.20; }
  58%  { opacity:.46; }
  74%  { opacity:.24; }
  100% { opacity:.18; }
}

/* ‚ùÑÔ∏è Souffle froid au scroll (brume verticale). Fallback = l√©ger flottement. */
:root[data-theme="noel"] body::before{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1; /* derri√®re le contenu (body est isol√©) */
  opacity: .20;
  background:
    linear-gradient(180deg,
      rgba(210,245,255,0.00) 0%,
      rgba(210,245,255,0.06) 18%,
      rgba(210,245,255,0.10) 42%,
      rgba(210,245,255,0.06) 68%,
      rgba(210,245,255,0.00) 100%);
  filter: blur(10px);
  animation: noelColdFloat 7.5s ease-in-out infinite alternate;
}

/* ‚úÖ Si Chrome supporte scroll-timeline, on ‚Äúlie‚Äù le mouvement au scroll */
@supports (animation-timeline: scroll()){
  :root[data-theme="noel"] body::before{
    animation: noelColdScroll 1s linear both;
    animation-timeline: scroll();
  }
}

@keyframes noelColdFloat{
  from{ transform: translateY(-1.5%); opacity: .14; }
  to  { transform: translateY( 1.5%); opacity: .24; }
}
@keyframes noelColdScroll{
  from{ transform: translateY(-2.0%); opacity: .12; }
  to  { transform: translateY( 2.0%); opacity: .26; }
}

/* ‚ú® √âtincelles autour du curseur
   ‚ö†Ô∏è CSS pur ne peut pas ‚Äúsuivre‚Äù la souris : il faut que ton JS mette
   :root.style.setProperty('--mx', `${x}px`), '--my', `${y}px`
*/
:root[data-theme="noel"] body::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 9999;
  opacity: .65;
  mix-blend-mode: screen;
  background:
    radial-gradient(10px 10px at var(--mx, -999px) var(--my, -999px), rgba(255,255,255,.95) 0 2px, rgba(255,255,255,0) 60%),
    radial-gradient(14px 14px at calc(var(--mx, -999px) + 18px) calc(var(--my, -999px) - 10px), rgba(120,220,255,.70) 0 2px, rgba(120,220,255,0) 62%),
    radial-gradient(12px 12px at calc(var(--mx, -999px) - 14px) calc(var(--my, -999px) + 12px), rgba(255,210,120,.70) 0 2px, rgba(255,210,120,0) 62%);
  filter: blur(.15px);
  animation: noelCursorSpark 1.1s steps(2,end) infinite;
}

@keyframes noelCursorSpark{
  0%   { opacity:.20; }
  35%  { opacity:.65; }
  60%  { opacity:.28; }
  100% { opacity:.20; }
}

@media (prefers-reduced-motion: reduce){
  :root[data-theme="noel"] header.topbar::before,
  :root[data-theme="noel"] .topbar::before,
  :root[data-theme="noel"] header.topbar::after,
  :root[data-theme="noel"] .topbar::after,
  :root[data-theme="noel"] body::before,
  :root[data-theme="noel"] body::after{
    animation: none !important;
  }
}



/* =====================================================
   AJOUTS FX ‚Äî HALLOWEEN üéÉ
   - Chauves-souris silhouettes rares (‚âà toutes 40‚Äì90s) via anim longue
   - Braises flottantes dans le bas de page
   - Yeux dans le noir quand immobile (via data-idle="1" + --eyes-a)
   ===================================================== */

/* ü¶á Bats : overlay discret (une longue anim, ‚Äúvisible‚Äù seulement sur un court passage) */
:root[data-theme="halloween"] body::before{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 9998;
  opacity: 0;
  background-repeat: no-repeat;
  background-size: 120px 60px, 90px 45px;
  background-position: -20% 18%, -20% 32%;
  /* silhouettes simples via gradients (noir semi transparent) */
  background-image:
    radial-gradient(closest-side, rgba(0,0,0,.55) 0 65%, rgba(0,0,0,0) 70%),
    radial-gradient(closest-side, rgba(0,0,0,.45) 0 65%, rgba(0,0,0,0) 70%);
  filter: blur(.2px);
  animation: halloweenBats 82s linear infinite;
}

/* üî• Embers : bas de page, petites particules qui montent */
:root[data-theme="halloween"] body::after{
  content:"";
  position: fixed;
  left: 0; right: 0;
  bottom: 0;
  height: 44vh;
  pointer-events: none;
  z-index: 9997;
  opacity: .38;
  background-image:
    radial-gradient(circle, rgba(255,120,40,.55) 0 1.2px, transparent 2.6px),
    radial-gradient(circle, rgba(255,70,0,.35) 0 1.0px, transparent 2.4px),
    radial-gradient(circle, rgba(255,200,90,.28) 0 0.9px, transparent 2.2px);
  background-size: 160px 140px, 220px 180px, 320px 240px;
  background-position: 0 0, 60px 40px, 140px 10px;
  background-repeat: repeat;
  filter: blur(.15px);
  animation: halloweenEmbers 9.8s linear infinite;
}

@keyframes halloweenBats{
  /* 0‚Äì70% invisible, puis passage rapide, puis re-dispara√Æt */
  0%   { opacity: 0; transform: translateX(0); background-position: -20% 18%, -20% 32%; }
  68%  { opacity: 0; }
  72%  { opacity: .30; }
  78%  { opacity: .38; transform: translateX(0); background-position: 120% 14%, 110% 30%; }
  82%  { opacity: 0; }
  100% { opacity: 0; background-position: -20% 18%, -20% 32%; }
}

@keyframes halloweenEmbers{
  0%{
    transform: translateY(0);
    background-position: 0 80px, 60px 120px, 140px 160px;
    opacity: .30;
  }
  50%{
    transform: translateY(-14px);
    background-position: 10px 10px, 90px 40px, 120px 70px;
    opacity: .42;
  }
  100%{
    transform: translateY(-28px);
    background-position: -10px -60px, 40px -30px, 180px -10px;
    opacity: .30;
  }
}

@media (prefers-reduced-motion: reduce){
  :root[data-theme="halloween"] body::before,
  :root[data-theme="halloween"] body::after{
    animation: none !important;
  }
}
